---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
    toc: true
---


## Loading and preprocessing the data
```{r load_libraries, message = FALSE}
library("dplyr")
library("lubridate")
```

```{r load_data}
if (!file.exists("activity.csv"))
    unzip("activity.zip", files = c("activity.csv"))

activity <- tibble::as_tibble(read.csv("activity.csv"))
activity$date <- ymd(activity$date)
```

## What is mean total number of steps taken per day?
```{r num_steps/day}
steps_by_day <- activity %>%
                group_by(date) %>%
                summarize(steps = sum(steps, na.rm = TRUE))

hist(steps_by_day$steps,
     xlab = "steps/day",
     ylab = "frequency",
     main = "Frequencies of steps/day")

mean_of_steps <- mean(steps_by_day$steps)
median_of_steps <- median(steps_by_day$steps)

abline(v = mean_of_steps,   col = "red")
abline(v = median_of_steps, col = "blue")

legend(legend = c("mean", "median"),
       col = c("red", "blue"),
       x = "topright",
       lty = 1)

mean_of_steps
median_of_steps
```


## What is the average daily activity pattern?

```{r daily_activity_pattern}
daily_activity <- activity %>%
                  group_by(interval) %>%
                  summarize(steps = mean(steps, na.rm = TRUE))

plot(daily_activity$interval, daily_activity$steps,
     type = "l",
     xlab = "interval index",
     ylab = "average number of steps",
     main = "Daily activity pattern")

busiest_interval <- daily_activity$interval[which.max(daily_activity$steps)]

abline(v = busiest_interval, col = "red")

legend(legend = c("busiest interval"),
       col = c("red"),
       x = "topright",
       lty = 1)

busiest_interval
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?

<!-- vim: set ts=4 sw=4 et tw=80 cc=80: -->
